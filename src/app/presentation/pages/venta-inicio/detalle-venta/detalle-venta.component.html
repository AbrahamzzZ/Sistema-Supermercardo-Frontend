<div class="venta">
  <h1 class="venta__titulo">Detalle de la Venta</h1>

  <div class="venta__contenedor">
    <form class="venta__formulario" [formGroup]="venta">

      <!-- BUSCADOR -->
      <div class="venta__busqueda">
        <div class="venta__busqueda-wapper">
          <mat-form-field appearance="outline" class="form__field__search">
            <mat-label>Buscar venta</mat-label>
            <input
              matInput
              #searchInput
              (keyup)="filtrarVenta(searchInput.value)"
              placeholder="Ingrese un número de documento."
            />
            <mat-icon matSuffix>search</mat-icon>
          </mat-form-field>

          @if(mensajeBusqueda){
            <div class="venta__busqueda-mensaje">
              <mat-icon color="warn">error</mat-icon>
              <span class="venta__mensaje-error">{{ mensajeBusqueda }}</span>
            </div>
          }
        </div>  
        <div class="venta__busqueda-actions">
          <button mat-raised-button color="warn" (click)="limpiar()">
            <mat-icon>cleaning_services</mat-icon>
            Limpiar
          </button>

          <button mat-raised-button color="accent" (click)="descargarPDF()">
            <mat-icon>add_circle</mat-icon>
            Descargar PDF
          </button>
        </div>
       </div>

      <p>Detalles</p>

      <!-- SECCIÓN PRINCIPAL -->
      <div class="venta__seccion">
        <!-- DATOS -->
        <div class="venta__grupo">
          <mat-form-field appearance="outline" class="form__field">
            <mat-label>Fecha: </mat-label>
            <input matInput formControlName="fecha" readonly />
          </mat-form-field>

          <mat-form-field appearance="outline" class="form__field">
            <mat-label>Tipo Documento: </mat-label>
            <input matInput formControlName="tipoDocumento" readonly />
          </mat-form-field>

          <mat-form-field appearance="outline" class="form__field">
            <mat-label>Usuario: </mat-label>
            <input matInput formControlName="nombreUsuario" readonly />
          </mat-form-field>     
        </div>

        <!-- SUCURSAL -->
        <div class="venta__grupo">
          <mat-form-field appearance="outline" class="form__field">
            <mat-label>Nombre: </mat-label>
            <input matInput formControlName="nombreSucursal" readonly />
          </mat-form-field>

          <mat-form-field appearance="outline" class="form__field">
            <mat-label>Dirección: </mat-label>
            <input matInput formControlName="direccionSucursal" readonly />
          </mat-form-field>
        </div>

        <!-- CLIENTE -->
        <div class="venta__grupo">
          <mat-form-field appearance="outline" class="form__field">
            <mat-label>Código: </mat-label>
            <input matInput formControlName="codigoCliente" readonly />
          </mat-form-field>
          
          <mat-form-field appearance="outline" class="form__field">
            <mat-label>Cliente: </mat-label>
            <input matInput formControlName="cliente" readonly />
          </mat-form-field>

          <mat-form-field appearance="outline" class="form__field">
            <mat-label>Cédula: </mat-label>
            <input matInput formControlName="cedulaCliente" readonly />
          </mat-form-field>
        </div>
      </div>

      <!-- TOTALES -->
      <div class="venta__grupo venta__grupo--totales">
        <div class="campo-horizontal">
          <mat-label>Total a Pagar: </mat-label>
          <mat-form-field appearance="outline" class="form__field">
            <input matInput formControlName="totalPagar" readonly />
            <span matTextPrefix>$&nbsp;</span>
          </mat-form-field>
        </div>

        <div class="campo-horizontal">
          <mat-label>Con descuento: </mat-label>
          <mat-form-field appearance="outline" class="form__field">
            <input matInput formControlName="conDescuento" readonly />
            <span matTextPrefix>$&nbsp;</span>
          </mat-form-field>
        </div>

        <div class="campo-horizontal">
          <mat-label>Paga con: </mat-label>
          <mat-form-field appearance="outline" class="form__field">
            <input matInput formControlName="pagaCon" readonly />
            <span matTextPrefix>$&nbsp;</span>
          </mat-form-field>
        </div>

        <div class="campo-horizontal">
          <mat-label>Cambio: </mat-label>
          <mat-form-field appearance="outline" class="form__field">
            <input matInput formControlName="cambio" readonly />
            <span matTextPrefix>$&nbsp;</span>
          </mat-form-field>
        </div>
      </div>

      <!-- TABLA -->
      <div class="venta__tabla">
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef>ID</th>
            <td mat-cell *matCellDef="let element">{{ element.id_Producto }}</td>
          </ng-container>

          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef>Nombre</th>
            <td mat-cell *matCellDef="let element">{{ element.productos }}</td>
          </ng-container>

          <ng-container matColumnDef="precio_Venta">
            <th mat-header-cell *matHeaderCellDef>Precio Venta</th>
            <td mat-cell *matCellDef="let element">
              {{ element.precio_Venta | currency: 'USD' : 'symbol' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="cantidad">
            <th mat-header-cell *matHeaderCellDef>Cantidad</th>
            <td mat-cell *matCellDef="let element">{{ element.cantidad }}</td>
          </ng-container>

          <ng-container matColumnDef="subTotal">
            <th mat-header-cell *matHeaderCellDef>Subtotal</th>
            <td mat-cell *matCellDef="let element">
              {{ element.subTotal | currency: 'USD' : 'symbol' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="descuento">
            <th mat-header-cell *matHeaderCellDef>Descuento</th>
            <td mat-cell *matCellDef="let element">{{ element.descuento + '%' }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="columnasTabla"></tr>
          <tr mat-row *matRowDef="let row; columns: columnasTabla"></tr>
        </table>

        <mat-paginator [pageSize]="3" [pageSizeOptions]="[3]" showFirstLastButtons></mat-paginator>
      </div>
    </form>
  </div>
</div>